<!DOCTYPE html>
<html>
<head>
  <title>Mobile Runner Game with Blackish Raiku</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    body { margin: 0; padding: 0; overflow: hidden; background: #fff; }
    canvas { display: block; width: 100vw; height: 100vh; background: #fff; }
    #startScreen, #gameOverScreen {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.6); color: white;
      display: flex; justify-content: center; align-items: center; flex-direction: column;
      text-align: center; font-family: Arial; transition: opacity 0.5s; opacity: 1;
    }
    #startScreen.hidden, #gameOverScreen.hidden { display: none; }
    button {
      padding: 10px 20px; font-size: 18px; background: #007bff; color: white;
      border: none; border-radius: 5px; cursor: pointer;
    }
    #debug { position: absolute; top: 10px; left: 10px; color: black; font-size: 14px; z-index: 10; }
  </style>
</head>
<body>
  <div id="startScreen">
    <h1>Tap to Play</h1>
    <button id="startButton">Start</button>
  </div>
  <div id="gameOverScreen" class="hidden">
    <h1>Game Over</h1>
    <p>Score: <span id="finalScore">0</span></p>
    <button id="restartButton">Restart</button>
  </div>
  <canvas id="gameCanvas"></canvas>
  <div id="debug"></div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const debug = (m)=>document.getElementById("debug").textContent=m;

    function resizeCanvas() {
      const dpr = window.devicePixelRatio || 1;
      canvas.width = window.innerWidth * dpr;
      canvas.height = window.innerHeight * dpr;
      ctx.scale(dpr, dpr);
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    const dpr = window.devicePixelRatio || 1;
    const LANE_WIDTH = (canvas.width / dpr) / 3;
    const GROUND_Y = canvas.height / dpr - 80;

    let player = { lane: 1, x: LANE_WIDTH + (LANE_WIDTH - 40)/2, y: GROUND_Y - 60, width: 40, height: 60,
      baseSpeed: 6, speed: 6, maxSpeed: 12, jumping:false, yVelocity:0, gravity:0.6, jumpPower:12, runFrame:0 };
    const playerImage = new Image();
    playerImage.src = "https://raw.githubusercontent.com/DrKrishnaM/raiku-image/main/1759800939823.jpg";

    let obstacles = [], score = 0, gameOver = false, gameStarted = false, lastSpawn = 0, spawnInterval = 100;
    let baseObstacleSpeed = 4;

    function drawBackground(){
      const g=ctx.createLinearGradient(0,0,0,canvas.height/dpr);
      g.addColorStop(0,"#87CEEB"); g.addColorStop(1,"#E0F6FF");
      ctx.fillStyle=g; ctx.fillRect(0,0,canvas.width/dpr,canvas.height/dpr);
      ctx.fillStyle="#4CAF50"; ctx.fillRect(0,GROUND_Y,canvas.width/dpr,80);
      ctx.fillStyle="#808080"; ctx.fillRect(0,GROUND_Y+20,canvas.width/dpr,40);
      ctx.fillStyle="white"; for(let x=0;x<canvas.width/dpr;x+=60) ctx.fillRect(x,GROUND_Y+35,30,5);
    }

    function drawPlayer(){
      if (playerImage.complete) ctx.drawImage(playerImage,player.x,player.y,player.width,player.height);
      else { ctx.fillStyle="red"; ctx.fillRect(player.x,player.y,player.width,player.height); }
    }

    function spawnObstacle(){
      const lane = Math.floor(Math.random()*3);
      const height = 40+Math.random()*40;
      obstacles.push({x:canvas.width/dpr, y:GROUND_Y-height, width:40, height, lane, speed:baseObstacleSpeed});
    }

    function update(){
      if(!gameStarted||gameOver) return;

      ctx.clearRect(0,0,canvas.width/dpr,canvas.height/dpr);
      drawBackground();

      player.yVelocity += player.gravity;
      player.y += player.yVelocity;
      if(player.y>GROUND_Y-player.height){player.y=GROUND_Y-player.height;player.jumping=false;player.yVelocity=0;}
      drawPlayer();

      lastSpawn++;
      if(lastSpawn>spawnInterval){spawnObstacle();lastSpawn=0;}

      obstacles.forEach(o=>{
        o.x -= o.speed;
        const obsX = o.x + LANE_WIDTH*o.lane;
        ctx.fillStyle="orange"; ctx.fillRect(obsX,o.y,o.width,o.height);
        if(player.lane===o.lane && player.x<obsX+o.width && player.x+player.width>obsX && player.y<o.y+o.height && player.y+player.height>o.y){
          gameOver=true;
          document.getElementById("finalScore").textContent=score;
          document.getElementById("gameOverScreen").classList.remove("hidden");
        }
      });
      obstacles=obstacles.filter(o=>o.x>-100);
      score++;
      ctx.fillStyle="black"; ctx.font="16px Arial"; ctx.fillText(`Score: ${score}`,10,30);
      requestAnimationFrame(update);
    }

    function startGame(){
      debug("Starting...");
      if(gameStarted) return;
      gameStarted=true; gameOver=false;
      document.getElementById("startScreen").classList.add("hidden");
      setTimeout(()=>update(),0);
    }

    function restartGame(){
      obstacles=[]; score=0; gameOver=false; gameStarted=true;
      document.getElementById("gameOverScreen").classList.add("hidden");
      setTimeout(()=>update(),0);
    }

    document.getElementById("startButton").addEventListener("click", startGame);
    document.getElementById("restartButton").addEventListener("click", restartGame);
    canvas.addEventListener("touchstart",()=>{if(!gameStarted)startGame();},{passive:true});

    debug("Ready!");
  </script>
</body>
</html>
